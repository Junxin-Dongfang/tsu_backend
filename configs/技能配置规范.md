# 游戏数据配置表规范化设计

## 表格结构说明

### 1. 【角色数据类型】表
**用途：**定义角色的基础属性和数据类型

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 代码 | 文本 | ✓ | 唯一标识符，用于程序引用 | STR |
| 名称 | 文本 | ✓ | 显示名称 | 力量 |
| 分类 | 文本 | ✓ | 属性分类 | Attribute / Data / Resistance |
| 数据类型 | 文本 | ✓ | 数值类型 | integer / percentage / float |
| 最小值 | 数字 |  | 属性最小值 | 1 |
| 最大值 | 数字 |  | 属性最大值 | 100 |
| 默认值 | 数字 | ✓ | 初始值 | 10 |
| 描述 | 文本 |  | 详细说明 | 影响物理攻击力和负重 |

**填写规范：**
- 代码必须全大写，使用下划线分隔
- 分类固定选项：Attribute（基础属性）、Data（计算数据）、Resistance（抗性）
- 数据类型固定选项：integer（整数）、percentage（百分比）、float（小数）

---

### 2. 【伤害类型】表
**用途：**定义游戏中的伤害类型和相关属性

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 代码 | 文本 | ✓ | 唯一标识符 | PHYSICAL |
| 名称 | 文本 | ✓ | 显示名称 | 物理伤害 |
| 分类 | 文本 | ✓ | 伤害分类 | physical / elemental |
| 抗性属性 | 文本 |  | 对应的抗性属性代码 | PHYSICAL_RESIST |
| 伤害减免属性 | 文本 |  | 伤害减免属性代码 | PHYSICAL_REDUCE |
| 颜色 | 文本 |  | 十六进制颜色代码 | #8B4513 |
| 描述 | 文本 |  | 详细说明 | 来自武器和物理攻击的伤害 |

**填写规范：**
- 代码必须全大写
- 分类固定选项：physical（物理）、elemental（元素）
- 颜色格式：#RRGGBB（如 #FF0000）

---

### 3. 【公式变量定义】表
**用途：**定义表达式中可使用的变量

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 变量代码 | 文本 | ✓ | 变量标识符 | STR |
| 变量名称 | 文本 | ✓ | 显示名称 | 力量 |
| 变量类型 | 文本 | ✓ | 变量分类 | 基础属性 / 技能数据 / 装备数据 |
| 作用域 | 文本 | ✓ | 数据来源范围 | character / equipment / skill / action |
| 数据类型 | 文本 | ✓ | 数值类型 | integer / float / string / boolean |
| 说明 | 文本 | ✓ | 详细描述 | 角色的力量属性值 |
| 示例 | 文本 |  | 使用示例 | STR*2+10 |

**填写规范：**
- 变量代码推荐全大写，可使用下划线
- 作用域固定选项：character、equipment、skill、action、system
- 数据类型：integer、float、string、boolean、array

---

### 4. 【元效果类型定义】表
**用途：**定义游戏中的原子级效果

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 元效果代码 | 文本 | ✓ | 唯一标识符 | HIT_CHECK |
| 名称 | 文本 | ✓ | 显示名称 | 命中检定 |
| 描述 | 长文本 | ✓ | 详细功能说明 | 进行攻击命中判定... |
| 参数列表 | 文本 | ✓ | 参数名称，逗号分隔 | MATCH_TARGET,MATCH_FLAG |
| 参数说明 | 长文本 | ✓ | 每个参数的详细说明 | MATCH_TARGET:匹配目标... |
| 失败处理 | 文本 | ✓ | 失败时的行为 | skip_remaining / continue |
| JSON模板 | 长文本 | ✓ | 配置模板 | {"effect":"HIT_CHECK"...} |

**填写规范：**
- 元效果代码全大写，使用下划线
- 失败处理固定选项：skip_remaining（跳过后续）、continue（继续执行）
- JSON模板必须是有效的JSON格式

---

### 5. 【动作类别】表
**用途：**定义动作的分类

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 类别代码 | 文本 | ✓ | 唯一标识符 | BASIC_ATTACK |
| 类别名称 | 文本 | ✓ | 显示名称 | 基础攻击 |
| 描述 | 文本 |  | 详细说明 | 基础的物理和魔法攻击动作 |

---

### 6. 【技能配置】表
**用途：**定义技能属性和解锁的动作

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 代码 | 文本 | ✓ | 唯一标识符 | SWORD_PROFICIENCY |
| 名称 | 文本 | ✓ | 显示名称 | 剑类熟练 |
| 技能类型 | 文本 | ✓ | 技能分类 | Weapon / magic / movement |
| 最大等级 | 整数 | ✓ | 技能最高等级 | 40 |
| 特征标签 | 文本 |  | 特征，逗号分隔 | weapon,melee,sword,Proficiency |
| 被动效果 | 长文本 |  | 被动效果JSON配置 | null 或 JSON字符串 |
| 解锁动作 | 长文本 |  | 解锁的动作列表JSON | [{"action":"xxx","level":1}] |
| 描述 | 文本 |  | 详细说明 | 熟练掌握各种剑类武器 |

**填写规范：**
- 解锁动作格式：`[{"action":"动作代码","unlock_level":解锁等级}]`
- 特征标签用英文逗号分隔，不要有空格

---

### 7. 【动作配置】表
**用途：**定义完整的游戏动作

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 动作代码 | 文本 | ✓ | 唯一标识符 | weapon_attack_sword |
| 动作名称 | 文本 | ✓ | 显示名称 | 剑类武器攻击 |
| 动作类别 | 文本 | ✓ | 所属类别代码 | BASIC_ATTACK |
| 动作类型 | 文本 | ✓ | 动作类型 | main / minor / reaction |
| 特征标签 | 文本 |  | 特征，逗号分隔 | attack,melee,sword |
| 关联技能 | 文本 | ✓ | 调用的技能代码 | SWORD_PROFICIENCY |
| 射程配置 | 文本 | ✓ | 射程规则字符串 | range:0;positions:最近1位;depth:单体 |
| 效果配置 | 长文本 | ✓ | 完整的效果JSON配置 | {"Basic_consume":...} |
| 开始标记 | 文本 |  | 动作开始时的FLAG | STARTING_ATTACK_ACTION |
| 需求条件 | 文本 |  | 使用条件表达式 | 无 或条件表达式 |
| 描述 | 文本 |  | 详细说明 | 使用剑类武器进行近战攻击 |

**填写规范：**
- 动作类型固定选项：main、minor、reaction
- 射程配置格式：`range:射程;positions:位置选择;depth:深度`
- 开始标记用分号分隔多个FLAG

---

### 8. 【Buff配置】表
**用途：**定义游戏中的状态效果

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 代码 | 文本 | ✓ | 唯一标识符 | BLEED |
| 名称 | 文本 | ✓ | 显示名称 | 流血 |
| 特征标签 | 文本 |  | 特征，逗号分隔 | negative,bleed,ConDMG |
| 分类 | 文本 | ✓ | Buff分类 | body / magic / environment |
| 默认持续时间 | 整数 | ✓ | 默认回合数 | 3 |
| 效果描述 | 长文本 | ✓ | 效果说明 | HP每回合减少N%*角色等级 |
| 叠加规则 | 文本 | ✓ | 叠加方式 | 不叠加 / 可叠加 / 替换 |
| 参数列表 | 文本 |  | 参数名称，逗号分隔 | N |
| 参数定义 | 长文本 |  | 参数详细定义JSON | {"N":{"type":"percentage"...}} |
| 描述 | 文本 |  | 详细说明 | 使角色持续受到流血伤害 |

---

### 9. 【动作标记】表
**用途：**定义动作过程中的状态标记

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 代码 | 文本 | ✓ | 唯一标识符 | Crit_Confirmed |
| 名称 | 文本 | ✓ | 显示名称 | 确认暴击 |
| 分类 | 文本 | ✓ | 标记分类 | action_chain / check_status |
| 持续类型 | 文本 | ✓ | 持续方式 | action / turn / permanent |
| 默认持续时间 | 文本 |  | 持续时间 | - 或具体数值 |
| 自动移除条件 | 文本 |  | 移除触发条件 | act_end / next_act_start |
| 是否可见 | 布尔 | ✓ | 玩家是否可见 | true / false |
| 描述 | 文本 |  | 详细说明 | 记录本动作是否成功暴击 |

---

### 10. 【射程配置规则】表
**用途：**射程配置的格式说明

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 参数类型 | 文本 | ✓ | 参数分类 | 射程范围 / 位置选择 / 深度选择 |
| 参数格式 | 文本 | ✓ | 格式规则 | N / 0~N / 最近1位 |
| 说明 | 文本 | ✓ | 详细说明 | 最大范围N，可选位置为... |
| 示例 | 文本 | ✓ | 使用示例 | range:3 |
| 备注 | 文本 |  | 补充说明 | 包括自身位置 |

---

### 11. 【技能升级消耗】表
**用途：**定义技能升级所需资源

| 字段名 | 数据类型 | 必填 | 说明 | 示例值 |
|--------|----------|------|------|--------|
| 等级 | 整数 | ✓ | 目标等级 | 1 |
| 经验消耗 | 整数 | ✓ | 所需经验值 | 100 |
| 金币消耗 | 整数 | ✓ | 所需金币 | 50 |

---

## 配置示例和规范

### JSON配置格式规范

#### 1. 效果配置示例
```json
{
    "Basic_consume": {
        "action": "main",
        "action_number": "1",
        "mp_cost": "0"
    },
    "Effects": [
        {
            "effect": "HIT_CHECK",
            "params": {
                "MATCH_TARGET": "0",
                "MATCH_FLAG": "0",
                "Key_Attribute_1": "STR",
                "Key_Attribute_2": "AGI",
                "AccSkill_Type": "SWORD_PROFICIENCY"
            },
            "order": 0
        }
    ]
}
```

#### 2. 技能解锁动作示例
```json
[
    {
        "action": "weapon_attack_sword",
        "unlock_level": 1
    }
]
```

### 表达式规范

#### 支持的运算符
- 算术运算：`+`, `-`, `*`, `/`, `%`
- 比较运算：`>`, `<`, `>=`, `<=`, `==`, `!=`
- 逻辑运算：`AND`, `OR`, `NOT`
- 条件运算：`条件 ? 值1 : 值2`

#### 表达式示例
- `STR * 2 + skill_level`
- `skill_level > 10 ? damage * 2 : damage`
- `(STR > 15 AND weapon_type == 'sword') ? bonus : 0`

### 数据验证规则

1. **代码命名规范**
   - 使用英文大写字母和下划线
   - 不能以数字开头
   - 长度不超过50字符

2. **JSON格式验证**
   - 必须是有效的JSON格式
   - 字符串值使用双引号
   - 数值不加引号

3. **引用完整性**
   - 技能解锁的动作必须在动作配置表中存在
   - 动作调用的技能必须在技能配置表中存在
   - 变量引用必须在变量定义表中存在

4. **数据类型检查**
   - 整数字段只能填入整数
   - 布尔字段只能填入true/false
   - 必填字段不能为空

### 填表注意事项

1. **版本管理**
   - 每次修改配置时，需要更新版本号
   - 重大修改需要在描述中说明变更内容

2. **向后兼容**
   - 不要轻易删除已有的代码
   - 新增功能通过新增记录实现
   - 废弃功能通过is_active字段控制

3. **测试验证**
   - 配置完成后必须进行数据验证
   - 复杂的JSON配置建议先在JSON验证工具中检查
   - 表达式配置需要测试各种边界情况

---

**策划填表时请严格按照以上规范，确保数据的准确性和一致性！**