FROM golang:1.25.1-alpine

WORKDIR /app

# 安装必要的工具，包括git和时区数据库
RUN apk add --no-cache git tzdata

# 安装air用于热重载
RUN go install github.com/air-verse/air@v1.63.0

# 复制go.mod和go.sum
COPY go.mod go.sum ./
RUN go mod download

# 复制源码（开发时会被volume覆盖）
COPY . .

EXPOSE 8072

# 使用air启动，实现热重载，使用专用的配置文件
CMD ["air", "-c", ".air.game.toml"]
