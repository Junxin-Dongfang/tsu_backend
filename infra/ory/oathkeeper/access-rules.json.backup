[
  {
    "id": "tsu-cors-preflight-rule",
    "match": {
      "url": "http://<.*>/api/admin/<.*>",
      "methods": ["OPTIONS"]
    },
    "authenticators": [{ "handler": "noop" }],
    "authorizer": { "handler": "allow" },
    "mutators": [{ "handler": "noop" }],
    "upstream": {
      "url": "http://tsu_admin:8071",
      "strip_path": "/api/admin"
    }
  },
  {
    "id": "tsu-auth-api-rule",
    "match": {
      "url": "http://<.*>/api/admin/auth/<(register|login)>",
      "methods": ["POST"]
    },
    "authenticators": [{ "handler": "noop" }],
    "authorizer": { "handler": "allow" },
    "mutators": [{ "handler": "noop" }],
    "upstream": {
      "url": "http://tsu_admin:8071",
      "strip_path": "/api/admin"
    }
  },
  {
    "id": "tsu-admin-protected-api-rule",
    "match": {
      "url": "http://<.*>/api/admin/admin/<.*>",
      "methods": ["GET", "POST", "PUT", "DELETE", "PATCH"]
    },
    "authenticators": [
      { "handler": "bearer_token" },
      { "handler": "cookie_session" }
    ],
    "authorizer": { "handler": "allow" },
    "mutators": [{ "handler": "header" }],
    "upstream": {
      "url": "http://tsu_admin:8071",
      "strip_path": "/api/admin"
    }
  },
  {
    "id": "tsu-user-protected-api-rule",
    "match": {
      "url": "http://<.*>/api/admin/user/<.*>",
      "methods": ["GET", "POST", "PUT", "DELETE", "PATCH"]
    },
    "authenticators": [
      { "handler": "bearer_token" },
      { "handler": "cookie_session" }
    ],
    "authorizer": { "handler": "allow" },
    "mutators": [{ "handler": "header" }],
    "upstream": {
      "url": "http://tsu_admin:8071",
      "strip_path": "/api/admin"
    }
  }
]