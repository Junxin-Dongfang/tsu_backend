-- =============================================================================
-- Drop Core Infrastructure
-- 删除核心基础设施：函数、枚举类型、扩展等（按相反顺序）
-- =============================================================================

-- --------------------------------------------------------------------------------
-- 删除函数
-- --------------------------------------------------------------------------------
DROP FUNCTION IF EXISTS validate_enum_value(TEXT, TEXT);
DROP FUNCTION IF EXISTS create_standard_indexes(TEXT);
DROP FUNCTION IF EXISTS handle_user_finance_change();
DROP FUNCTION IF EXISTS update_updated_at_column();

-- --------------------------------------------------------------------------------
-- 删除枚举类型（如果没有被使用）
-- --------------------------------------------------------------------------------
DROP TYPE IF EXISTS action_type_enum;
DROP TYPE IF EXISTS skill_type_enum;
DROP TYPE IF EXISTS attribute_category_enum;
DROP TYPE IF EXISTS attribute_data_type_enum;
DROP TYPE IF EXISTS class_tier_enum;

-- --------------------------------------------------------------------------------
-- 删除扩展（谨慎操作，可能被其他对象使用）
-- --------------------------------------------------------------------------------
-- 通常不删除扩展，因为可能被其他对象使用
-- DROP EXTENSION IF EXISTS "uuid-ossp";

-- --------------------------------------------------------------------------------
-- 完成消息
-- --------------------------------------------------------------------------------
DO $$
BEGIN
    RAISE NOTICE '============================================';
    RAISE NOTICE 'Core Infrastructure 删除完成';
    RAISE NOTICE '============================================';
END $$;