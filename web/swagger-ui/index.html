<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TSU API æ–‡æ¡£</title>
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui.css" />
</head>
<body>
    <div id="swagger-ui"></div>
    <script src="https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui-bundle.js" crossorigin></script>
    <script>
        window.onload = () => {
            // ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„åè®®å’Œä¸»æœº
            const apiDocUrl = window.location.protocol + '//' + window.location.host + '/swagger/admin/doc.json';
            console.log('Loading Swagger from:', apiDocUrl);
            
            window.ui = SwaggerUIBundle({
                url: apiDocUrl,
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIBundle.presets.standalone,
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                docExpansion: "list",
                showRequestHeaders: true,
                showCommonExtensions: true,
                persistAuthorization: true,
                // æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨æ¥å¤„ç†CORS
                requestInterceptor: (request) => {
                    console.log('Request:', request);
                    return request;
                },
                responseInterceptor: (response) => {
                    console.log('Response:', response);
                    return response;
                },
                onComplete: function() {
                    // æ·»åŠ æœåŠ¡å™¨åˆ‡æ¢è¯´æ˜
                    setTimeout(() => {
                        const infoContainer = document.querySelector('.info');
                        if (infoContainer && !document.querySelector('#server-info')) {
                            const serverInfo = document.createElement('div');
                            serverInfo.id = 'server-info';
                            serverInfo.innerHTML = `
                                <div style="margin: 15px 0; padding: 15px; background: #e3f2fd; border-left: 4px solid #2196f3; border-radius: 4px;">
                                    <h4 style="margin: 0 0 10px 0;">ğŸŒ æœåŠ¡å™¨é…ç½®</h4>
                                    <p style="margin: 5px 0;"><strong>å½“å‰ä½¿ç”¨ï¼š</strong> localhost (nginxä»£ç†)</p>
                                    <p style="margin: 5px 0;"><strong>APIåŸºç¡€è·¯å¾„ï¼š</strong> /api/admin</p>
                                    <p style="margin: 5px 0; font-size: 12px; color: #666;">
                                        ğŸ’¡ æ‰€æœ‰APIæµ‹è¯•å°†é€šè¿‡nginxä»£ç†åˆ°åç«¯æœåŠ¡
                                    </p>
                                </div>
                            `;
                            infoContainer.appendChild(serverInfo);
                        }
                    }, 1000);
                }
            });
        };
    </script>
</body>
</html>